<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obstacle Maze Game</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #F0F0F0;
        }
        .content {
            display: flex;
            justify-content: center;
            align-items: start;
        }
        nav {
            width: 100%;
            display: flex;
            justify-content: space-around;
            background-color: #444;
            padding: 1em;
        }
        nav a {
            text-decoration: none;
            color: white;
            font-weight: bold;
            font-size: 1em;
            transition: color 0.3s ease-in-out;
        }
        nav a:hover {
            color: #FFCC00;
        }
        #maze {
            display: grid;
            grid-template-columns: repeat(20, 30px);
            grid-template-rows: repeat(20, 30px);
            gap: 1px;
            background-color: #000;
            margin-right: 20px; /* Space between maze and message box */
        }
        #messageBox {
            width: 300px;
            height: 600px; /* Same height as the maze */
            background-color: white;
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 10px;
            font-family: Arial, sans-serif;
            font-size: 16px;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .cell {
            width: 30px;
            height: 30px;
            box-sizing: border-box;
            border: 1px solid #fff;
        }
        #start {
            background-color: #00FF00;
        }
        #end {
            background-color: #FF0000;
        }
        #player {
            background-color: #0000FF;
        }
        #message {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            color: #000;
            font-size: 24px;
        }
    </style>
    {% include "layouts/navbar.html" %}
</head>
<body>
    <div class="content">
        <div id="maze"></div>
        <div id="messageBox">
            Draw anything on here! There are three colors to pick, thickness selectors, and a white eraser. Try to get creative! Studies show that drawing helps relieve cancer patients from their stress. Try an ocean with the blue color, with big waves and small waves (different px!). We hope this helps.
        </div>
    </div>
    <div id="message"></div>
    <script>
        const mazeContainer = document.getElementById('maze');
        const messageElement = document.getElementById('message');
        const mazeSize = 20;
        const obstacleDensity = 0.3; // Adjust density of obstacles (0 to 1)
        let playerPosition = { row: 0, col: 0 };
        // Generate random maze layout with obstacles
        const mazeLayout = Array.from({ length: mazeSize }, () =>
            Array.from({ length: mazeSize }, () =>
                Math.random() < obstacleDensity ? 1 : 0
            )
        );
        // Place start and end points
        mazeLayout[0][0] = 2; // Start
        mazeLayout[mazeSize - 1][mazeSize - 1] = 3; // End
        function createMaze() {
            for (let row = 0; row < mazeSize; row++) {
                for (let col = 0; col < mazeSize; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    switch (mazeLayout[row][col]) {
                        case 1:
                            cell.style.backgroundColor = '#000';
                            break;
                        case 2:
                            cell.style.backgroundColor = '#00FF00'; // Start
                            playerPosition = { row, col };
                            break;
                        case 3:
                            cell.style.backgroundColor = '#FF0000'; // End
                            break;
                        default:
                            cell.style.backgroundColor = '#fff'; // Path
                            break;
                    }
                    mazeContainer.appendChild(cell);
                }
            }
        }
        function updatePlayerPosition() {
            const playerCell = document.querySelector(`.cell[data-row="${playerPosition.row}"][data-col="${playerPosition.col}"]`);
            playerCell.style.backgroundColor = '#0000FF'; // Player color
        }
        function checkWin() {
            if (playerPosition.row === mazeSize - 1 && playerPosition.col === mazeSize - 1) {
                messageElement.textContent = 'Congratulations! You won!';
                // Change end cell color on win
                document.querySelector(`.cell[data-row="${mazeSize - 1}"][data-col="${mazeSize - 1}"]`).style.backgroundColor = '#00FF00';
            }
        }
        function movePlayer(event) {
            const { key } = event;
            const newRow = playerPosition.row + (key === 'ArrowDown' ? 1 : key === 'ArrowUp' ? -1 : 0);
            const newCol = playerPosition.col + (key === 'ArrowRight' ? 1 : key === 'ArrowLeft' ? -1 : 0);
            if (newRow >= 0 && newRow < mazeSize && newCol >= 0 && newCol < mazeSize) {
                const targetCell = mazeLayout[newRow][newCol];
                if (targetCell !== 1) {
                    // Restore start cell or path color
                    document.querySelector(`.cell[data-row="${playerPosition.row}"][data-col="${playerPosition.col}"]`).style.backgroundColor = targetCell === 2 ? '#00FF00' : '#fff';
                    playerPosition = { row: newRow, col: newCol };
                    updatePlayerPosition();
                    checkWin();
                }
            }
        }
        document.addEventListener('keydown', movePlayer);
        createMaze();
        updatePlayerPosition();
    </script>
</body>
</html>